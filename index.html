<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ficha de Júlio</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Roboto+Slab:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>

    <header class="hero-section">
        <div class="character-identity">
            <h1 id="char-name">--</h1>
            <h2 id="char-title">--</h2>
        </div>
        
        <div class="hero-grid">

            <div class="portrait-container">
                <img src="perfil.png" alt="Retrato" class="char-img">
                
                <button class="btn-journal-mini" onclick="toggleJournal(true)">
                    <i class="fas fa-book-open"></i> Diário
                </button>

                <button class="btn-journal-mini" onclick="toggleConfig(true)">
                    <i class="fas fa-cog"></i> Configuração
                </button>
            </div>

            
            <div class="bio-stats">
                <div class="identity-tags">
                    <div class="tag-box">
                        <span class="tag-label">Raça</span>
                        <span class="tag-val" id="char-race">--</span>
                    </div>
                    <div class="tag-box">
                        <span class="tag-label">Classe</span>
                        <span class="tag-val" id="char-class">--</span>
                    </div>
                </div>

                <hr class="bio-separator">

                <div class="bio-details">
                    <div class="bio-row">
                        <i class="fas fa-star icon-bio"></i> <strong>Nível:</strong> <span id="char-level-display">--</span>
                    </div>
                    <div class="bio-row">
                        <i class="fas fa-language icon-bio"></i>
                        <strong>Idiomas:</strong> <span id="bio-char-languages">--</span>
                    </div>
                    <div class="bio-row">
                        <i class="fas fa-history icon-bio"></i>
                        <strong>Antecedente:</strong> <span id="bio-background">--</span>
                    </div>
                    <div class="bio-row">
                        <i class="fas fa-balance-scale icon-bio"></i>
                        <strong>Alinhamento:</strong> <span id="bio-align">--</span>
                    </div>
                    <div class="bio-row">
                        <i class="fas fa-hourglass-half icon-bio"></i>
                        <strong>Idade:</strong> <span id="bio-age">--</span>
                    </div>
                    <div class="bio-row">
                        <i class="fas fa-walking icon-bio"></i>
                        <strong>Físico:</strong> <span id="bio-physique">--</span>
                    </div>
                    <div class="bio-row">
                        <i class="fas fa-eye icon-bio"></i>
                        <strong>Aparência:</strong> <span id="bio-appearance">--</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="panel stats-panel">
            <h3 class="section-title"><i class="fas fa-chart-bar"></i> Atributos</h3>
            
            <div class="attributes-container">
                <div class="attr-box"><span class="attr-label">FOR</span><span class="attr-val" id="score-str">10</span><span class="attr-mod" id="mod-str">+0</span></div>
                <div class="attr-box"><span class="attr-label">DES</span><span class="attr-val" id="score-dex">10</span><span class="attr-mod" id="mod-dex">+0</span></div>
                <div class="attr-box"><span class="attr-label">CON</span><span class="attr-val" id="score-con">10</span><span class="attr-mod" id="mod-con">+0</span></div>
                <div class="attr-box highlight-attr"><span class="attr-label">INT</span><span class="attr-val" id="score-int">10</span><span class="attr-mod" id="mod-int">+0</span></div>
                <div class="attr-box"><span class="attr-label">SAB</span><span class="attr-val" id="score-wis">10</span><span class="attr-mod" id="mod-wis">+0</span></div>
                <div class="attr-box"><span class="attr-label">CAR</span><span class="attr-val" id="score-cha">10</span><span class="attr-mod" id="mod-cha">+0</span></div>
            </div>

            <hr class="separator">

            <div class="hp-container">
                <div class="hp-label">
                    <span id="hp-label-name">PV</span>
                    <span class="hp-numbers"><span id="current-hp">--</span> / <span id="max-hp">--</span></span>
                </div>
                <div class="hp-bar-bg">
                    <div class="hp-bar-fill" id="hp-bar"></div>
                </div>
                <div class="hp-controls">
                    <button class="btn-damage" onclick="modifyHP('player', -1)"><i class="fas fa-minus"></i></button>
                    <button class="btn-heal" onclick="modifyHP('player', 1)"><i class="fas fa-plus"></i></button>
                </div>
            </div>

            <div class="stats-grid">
                <div class="stat-box"><span class="stat-label">CA</span><span class="stat-value" id="stat-ac">--</span></div>
                <div class="stat-box"><span class="stat-label">Iniciativa</span><span class="stat-value" id="stat-init">--</span></div>
                <div class="stat-box"><span class="stat-label">Desl.</span><span class="stat-value" id="stat-speed">--</span></div>
                <div class="stat-box highlight"><span class="stat-label">CD Magia</span><span class="stat-value" id="spell-dc">--</span></div>
                <div class="stat-box highlight"><span class="stat-label">Atk Mágico</span><span class="stat-value" id="spell-atk">--</span></div>
                <div class="stat-box"><span class="stat-label">Prof.</span><span class="stat-value" id="prof-bonus">--</span></div>
            </div>

            <div id="traits-injection-area" style="margin-top: 2rem; display: flex; flex-direction: column; gap: 10px;"></div>

            <hr class="separator">

            
        </section>

        <section class="panel spells-panel">
            <h3 class="section-title"><i class="fas fa-book-sparkles"></i> Lista de Magias</h3>
            
            <div id="spellbook-container"></div>
        </section>

        <section class="panel weapons-panel">
            <h3 class="section-title"><i class="fas fa-hammer"></i> Arsenal & Ferramentas</h3>
            <div class="weapons-grid" id="weapons-container">
                </div>
        </section>

        <section class="panel companion-panel steel-defender">
            <div class="pet-header-wrapper">
                <img src="defensor.png" alt="defensor de aço" class="companion-banner-img">
                <div class="pet-title-overlay">
                    <h3><i class="fas fa-spider"></i> <span id="def-name">Defensor</span></h3>
                </div>
            </div>

            <div class="pet-content-body">
                <div class="pet-hp-wrapper">
                    <div class="hp-controls">
                        <button class="btn-damage" onclick="modifyHP('defender', -1)"><i class="fas fa-minus"></i></button>
                    </div>
                    <div class="hp-bar-bg" style="height: 12px;">
                        <div class="hp-bar-fill" id="defender-hp-bar"></div>
                    </div>
                    <div class="hp-controls">
                        <button class="btn-heal" onclick="modifyHP('defender', 1)"><i class="fas fa-plus"></i></button>
                    </div>
                    <span id="defender-hp-text" style="font-size:0.9rem; font-weight:bold; min-width:40px; text-align:right;">--</span>
                </div>

                <div class="stat-block" style="border:none; background:transparent;">
                    <div class="stat-content" style="padding:0;">
                        </div>
                </div>
            </div>
        </section>

        <section class="panel companion-panel homunculus">
            <div class="pet-header-wrapper">
                <img src="humunculo.png" alt="homunculo" class="companion-banner-img">
                <div class="pet-title-overlay">
                    <h3><i class="fas fa-crow"></i> <span id="hom-name">Homúnculo</span></h3>
                </div>
            </div>

            <div class="pet-content-body">
                <div class="pet-hp-wrapper">
                    <div class="hp-controls">
                        <button class="btn-damage" onclick="modifyHP('homunculus', -1)"><i class="fas fa-minus"></i></button>
                    </div>
                    <div class="hp-bar-bg" style="height: 12px;">
                        <div class="hp-bar-fill" id="homunculus-hp-bar"></div>
                    </div>
                    <div class="hp-controls">
                        <button class="btn-heal" onclick="modifyHP('homunculus', 1)"><i class="fas fa-plus"></i></button>
                    </div>
                    <span id="homunculus-hp-text" style="font-size:0.9rem; font-weight:bold; min-width:40px; text-align:right;">--</span>
                </div>

                <div class="stat-block" style="border:none; background:transparent;">
                    <div class="stat-content" style="padding:0;">
                        </div>
                </div>
            </div>
        </section>

        <section class="panel lore-panel">
            <h3 class="section-title"><i class="fas fa-scroll"></i> História</h3>
            <div class="lore-content">
                <p id="char-lore">--</p>
            </div>
        </section>
    </main>


    <section id="journal-view" class="journal-overlay">
        <div class="journal-container">
            <header class="journal-header">
                <h2><i class="fas fa-feather-alt"></i> Diário de Campanha</h2>
                <button class="btn-close-journal" onclick="toggleJournal(false)"><i class="fas fa-times"></i></button>
            </header>

            <div class="journal-toolbar">
                <div class="journal-actions">
                    <button onclick="addJournalEntry('mission')"><i class="fas fa-scroll"></i> Missão</button>
                    <button onclick="addJournalEntry('npc')"><i class="fas fa-user-friends"></i> NPC</button>
                    <button onclick="addJournalEntry('note')"><i class="fas fa-sticky-note"></i> Nota</button>
                    <button onclick="addJournalEntry('loot')"><i class="fas fa-gem"></i> Item</button>
                </div>
                <div class="journal-io">
                    <button onclick="downloadJournal()" class="btn-save-json"><i class="fas fa-download"></i> Salvar JSON</button>
                    <button onclick="triggerLoadJournal()" class="btn-load-json"><i class="fas fa-upload"></i> Carregar JSON</button>
                    <input type="file" id="journal-upload" style="display: none;" accept=".json" onchange="loadJournal(this)">
                </div>
            </div>

            <div id="journal-entries-list" class="journal-content">
                <p class="empty-msg">Seu diário está vazio. Adicione notas acima ou carregue um arquivo.</p>
            </div>
        </div>
    </section>

    <div id="config-modal" class="config-overlay" style="display: none;">
        <div class="config-box">
            <header>
                <h3><i class="fas fa-cog"></i> Fonte de Dados</h3>
                <button onclick="toggleConfig(false)" class="btn-close-config"><i class="fas fa-times"></i></button>
            </header>
            
            <div class="config-options">
                <div class="config-group">
                    <label>Opção A: Link (Google Sheets CSV)</label>
                    <input type="text" id="cfg-url-input" placeholder="Cole o link 'Publicado na Web' aqui...">
                    <button onclick="saveUrlConfig()" class="btn-action">Usar Link</button>
                </div>

                <div class="divider"><span>OU</span></div>

                <div class="config-group">
                    <label>Opção B: Arquivo Local (.csv)</label>
                    <input type="file" id="cfg-file-input" accept=".csv">
                    <button onclick="processFileConfig()" class="btn-action">Carregar Arquivo</button>
                </div>
            </div>

            <div class="config-footer">
                <button onclick="resetConfig()" class="btn-reset">Restaurar Original</button>
            </div>
        </div>
    </div>

    <footer>
        <p>Criado por Júlio</p>
    </footer>

    <script src="database.js"></script> <script src="script.js"></script>
</body>
</html>